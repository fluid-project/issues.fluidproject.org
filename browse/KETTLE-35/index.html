<!DOCTYPE html>
<html lang="en" dir="ltr" data-color-scheme="light">
    <head>
        <title> KETTLE-35  | Fluid Project Issues Archive</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <meta name="description" content="Archive of Fluid Project issues from the JIRA issue tracker">
        <meta property="og:title" content=" KETTLE-35 |  Fluid Project Issues Archive">
        <meta property="og:description" content="Archive of Fluid Project issues">
        <meta property="og:locale" content="en">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://issues.fluidproject.org/browse/KETTLE-35/">
        <link rel="canonical" href="https://issues.fluidproject.org/browse/KETTLE-35/">


        <link rel="stylesheet" href="/assets/styles/style.css">

        
<script type="module" src="/assets/scripts/relative-time/bundle.js"></script>

    </head>
    <body class="page-issue">
        <header class="mt-3">
            <a class="skip-link" href="#main">Skip to Content</a>
            <nav aria-label="main menu">
                <menu>
                    <li><a rel="home" href="/">Home</a></li>
                    <li><a href="/search/">Search</a></li>
                </menu>
            </nav>
            
        <nav aria-label="breadcrumbs">
            <ol>
                <li><a rel="home" href="/">Home</a></li>
                <li><a href="/projects/KETTLE" data-pagefind-filter="project">Kettle</a></li>
                <li><a href="/browse/KETTLE-35/">KETTLE-35</a></li>
            </ol>
        </nav>
        <h1>KETTLE-35: kettle.dataSource.CouchDB.writable should be more easily able to read and write from different URLs...</h1>

        </header>
        <main id="main">
            
    <div id="content" class="content with-sidebar">
        <div class="spacing-y-1 bg-default">
            <h2>Metadata</h2>
            <dl>
                <div>
                    <dt>Source</dt>
                    <dd><a href="https://fluidproject.atlassian.net/browse/KETTLE-35">KETTLE-35</a></dd>
                </div>
                <div>
                    <dt>Type</dt>
                    <dd>
                        <a href="/projects/KETTLE/?type=Improvement">Improvement</a>
                    </dd>
                </div>
                <div>
                    <dt>Priority</dt>
                    <dd>Major</dd>
                </div>
                <div>
                    <dt>Status</dt>
                    <dd>Open</dd>
                </div>
                <div>
                    <dt>Resolution</dt>
                    <dd>
                            N/A
                        
                    </dd>
                </div>
                <div>
                    <dt>Assignee</dt>
                    <dd>Antranig Basman</dd>
                </div>
                <div>
                    <dt>Reporter</dt>
                    <dd>
                        <a href="/projects/KETTLE/?reporter=Tony%20Atkins%20%5BRtF%5D">Tony Atkins [RtF]</a>
                    </dd>
                </div>
                <div>
                    <dt>Created</dt>
                    <dd><relative-time datetime="2015-09-27T08:51:27.493-0400" prefix="">2015-09-27T08:51:27.493-0400</relative-time></dd>
                </div>
                <div>
                    <dt>Updated</dt>
                    <dd><relative-time datetime="2015-09-27T08:51:27.493-0400" prefix="">2015-09-27T08:51:27.493-0400</relative-time></dd>
                </div>
                <div>
                    <dt>Versions</dt>
                    <dd>
                        
                        N/A
                        
                    </dd>
                </div>
                <div>
                    <dt>Fixed Versions</dt>
                    <dd>
                        
                        N/A
                        
                    </dd>
                </div>
                <div>
                    <dt>Component</dt>
                    <dd>
                        
                        N/A
                        
                    </dd>
                </div>
            </dl>
        </div>

        <div>
            <div class="spacing-y-1">
                <h2>Description</h2>
                <p>In CouchDB, you are expected to know the current _id and _rev value of a record before you can update it.  kettle.dataSource.CouchDB.writable retrieves those values by making a call to that.get and then appending the existing _id and _rev values to the payload before POSTing to CouchDB.</p>
<p>As far as I can see, both that.get and that.set ultimately use the same termMap and url value.  This is reasonable for simple cases like GETing and POSTing a record with a known ID, when you expect to (for example) GET /db/id1 and POST /db/id1.  It is not reasonable for cases in which the id is not known, or in which you need to use a view to lookup a record by more than one existing field.</p>
<p>In those cases, you would more likely be looking up the original record using a view, and then updating the record through the standard document API.  There are many many use cases like this, to pick one at random, you might use a view to look up a user record by either username or email address, and then make a change to that record using the document API.</p>
<p>I have worked around this for the moment by making wrapper components that have a separate reader and writable child component.  These components use configuration blocks like the following to distinguish read and write conventions:</p>
<pre><code class="hljs language-java">urls: {
  read: <span class="hljs-string">"XXX"</span>,
  write: <span class="hljs-string">"YYY"</span>,
},
termMaps: {
  read: <span class="hljs-string">"ZZZ"</span>,
  write: <span class="hljs-string">"AAA"</span>
}
</code></pre>
<p>I would suggest that we evolve the writable couchDB grade to do something similar.  Just to avoid the same collision over and over again in other environments, we might also consider renaming the common fields (url, termMap, directOptions) in one or both of the underlying kettle.dataSource.URL and kettle.dataSource.URL.writable grades.</p>

            </div>
            
            
            
            
        </div>
    </div>

        </main>
        <footer>
            
<nav aria-labelledby="pagination">
    <h2 class="visually-hidden">pagination</h2>
    <p class="flex">
        
        
        <a class="mx-1" href="/browse/KETTLE-34/"><span class="aria-hidden">←</span> Previous: KETTLE-34</a>
        <a class="mx-1" href="/browse/KETTLE-36/">Next: KETTLE-36 <span class="aria-hidden">→</span></a>
    </p>
</nav>

        </footer>
    </body>
</html>