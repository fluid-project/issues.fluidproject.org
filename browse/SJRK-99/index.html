<!DOCTYPE html>
<html lang="en" dir="ltr" data-color-scheme="light">
    <head>
        <title> SJRK-99  | Fluid Project Issues Archive</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <meta name="description" content="Archive of Fluid Project issues from the JIRA issue tracker">
        <meta property="og:title" content=" SJRK-99 |  Fluid Project Issues Archive">
        <meta property="og:description" content="Archive of Fluid Project issues">
        <meta property="og:locale" content="en">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://issues.fluidproject.org/browse/SJRK-99/">
        <link rel="canonical" href="https://issues.fluidproject.org/browse/SJRK-99/">


        <link rel="stylesheet" href="/assets/styles/style.css">

        
<script type="module" src="/assets/scripts/relative-time/bundle.js"></script>

    </head>
    <body class="page-issue">
        <header class="mt-3">
            <a class="skip-link" href="#main">Skip to Content</a>
            <nav aria-label="main menu">
                <menu>
                    <li><a rel="home" href="/">Home</a></li>
                    <li><a href="/search/">Search</a></li>
                </menu>
            </nav>
            
        <nav aria-label="breadcrumbs">
            <ol>
                <li><a rel="home" href="/">Home</a></li>
                <li><a href="/projects/SJRK" data-pagefind-filter="project">Social Justice Repair Kit</a></li>
                <li><a href="/browse/SJRK-99/">SJRK-99</a></li>
            </ol>
        </nav>
        <h1>SJRK-99: Storytelling tool unable to save in certain circumstances</h1>

        </header>
        <main id="main">
            
    <div id="content" class="content with-sidebar">
        <div class="spacing-y-1 bg-default">
            <h2>Metadata</h2>
            <dl>
                <div>
                    <dt>Source</dt>
                    <dd><a href="https://fluidproject.atlassian.net/browse/SJRK-99">SJRK-99</a></dd>
                </div>
                <div>
                    <dt>Type</dt>
                    <dd>
                        <a href="/projects/SJRK/?type=Bug">Bug</a>
                    </dd>
                </div>
                <div>
                    <dt>Priority</dt>
                    <dd>Blocker</dd>
                </div>
                <div>
                    <dt>Status</dt>
                    <dd>Reopened</dd>
                </div>
                <div>
                    <dt>Resolution</dt>
                    <dd>
                            N/A
                        
                    </dd>
                </div>
                <div>
                    <dt>Assignee</dt>
                    <dd>N/A</dd>
                </div>
                <div>
                    <dt>Reporter</dt>
                    <dd>
                        <a href="/projects/SJRK/?reporter=Gregor%20Moss">Gregor Moss</a>
                    </dd>
                </div>
                <div>
                    <dt>Created</dt>
                    <dd><relative-time datetime="2018-05-28T17:55:18.431-0400" prefix="">2018-05-28T17:55:18.431-0400</relative-time></dd>
                </div>
                <div>
                    <dt>Updated</dt>
                    <dd><relative-time datetime="2022-07-29T00:09:39.327-0400" prefix="">2022-07-29T00:09:39.327-0400</relative-time></dd>
                </div>
                <div>
                    <dt>Versions</dt>
                    <dd>
                        
                        N/A
                        
                    </dd>
                </div>
                <div>
                    <dt>Fixed Versions</dt>
                    <dd>
                        
                        N/A
                        
                    </dd>
                </div>
                <div>
                    <dt>Component</dt>
                    <dd>
                        
                        <ol role="list">
                            
                            <li>Storytelling Tool Server</li>
                            
                            <li>Storytelling Tool UI</li>
                            
                        </ol>
                        
                    </dd>
                </div>
            </dl>
        </div>

        <div>
            <div class="spacing-y-1">
                <h2>Description</h2>
                <p>As reported by Michelle D'Souza: "Another issue that we hit - and I saw it on my phone too, was an inability to save. I was able to save a simple story, but when I tried to enter one that a student had sent us, it failed. One thing she did was put some emojis in the text as well as the title and the keywords. Dana can WhatsApp you the story."</p>
<p>The emoji are likely a factor, worth exploring</p>

            </div>
            
            
            
            
            <div class="spacing-y-1">
                <h2>Comments</h2>
                <ul class="spacing-y-2" role="list">
                    
                    <li id="comment-26658">
                        <p class="mb-0"><b>Gregor Moss</b> <i>commented <relative-time datetime="2018-05-29T12:57:54.469-0400">2018-05-29T12:57:54.469-0400</relative-time></i></p>
                        <p>I tested adding stories from my phone (Google Pixel XL, Android 8.1.0):</p>
<ul>
<li>one with emoji in a text block (in the 'text' field)</li>
<li>one with emoji in the title as well as a text block (again in the 'text' field)</li>
<li>one with emoji in the keywords as well as title and text block</li>
</ul>
<p>All seemed to save without issue while connected to the OCADU wireless network. Is it possible that certain emoji are causing it to trip up?</p>

                    </li>
                    
                    <li id="comment-26659">
                        <p class="mb-0"><b>Gregor Moss</b> <i>commented <relative-time datetime="2018-05-30T16:57:18.121-0400">2018-05-30T16:57:18.121-0400</relative-time></i></p>
                        <p>In testing on a Nexus 7 (2012) running Android 5.1.1 and Chrome 53 (mentioned in my tests for <a href="/browse/SJRK-98/">SJRK-98</a>), I noticed I was unable to save when an image block was added to the story. I connected the device to my machine and did remote debugging in order to inspect the browser console, and this error appeared when an image block was added:</p>
<p>Fluid.js:203 Uncaught Error: Assertion failure - check console for more details: Failed to resolve reference {editable}.updateImagePreview - could not match context with name editable from component { typeName: "sjrk.storyTelling.block.singleFileUploader" gradeNames: ["sjrk.storyTelling.block.singleFileUploader"] id: a8x2muug-4040} at path storyEdit-a8x2muug-83,storyEditor,blockManager,managedViewComponents,cameraCaptureUploader component: [object Object]</p>
<p></p>
<p>And when trying to save, this is the response from the server:</p>
<p>{"isError":true,"message":"Unexpected field","code":"LIMIT_UNEXPECTED_FILE","field":"uploadedFile","storageErrors":[]}</p>
<p>And after switching the language to Spanish, the response becomes</p>
<p>{"isError":true,"message":"Cannot read property 'filename' of undefined","stack":"TypeError: Cannot read property 'filename' of undefined\n at Arguments.&lt;anonymous&gt; (/usr/src/app/src/js/requestHandlers.js:147:40)\n at ...}</p>
<p></p>

                    </li>
                    
                    <li id="comment-26660">
                        <p class="mb-0"><b>Gregor Moss</b> <i>commented <relative-time datetime="2018-05-30T17:42:42.448-0400">2018-05-30T17:42:42.448-0400</relative-time></i></p>
                        <p>The issue seems to have been a leftover IoC reference from a time before the current factoring. it refers to {editable}, which no longer exists. I've updated it to {imageBlockEditor} as it should be, and the client-side error stopped happening.</p>
<p>I have pushed this fix to <a href="/browse/SJRK-91/">SJRK-91</a> branch. Once the server build has been updated, we can retry.</p>
<p>cc Alan Harnum Michelle D'Souza Dana</p>

                    </li>
                    
                    <li id="comment-26661">
                        <p class="mb-0"><b>Gregor Moss</b> <i>commented <relative-time datetime="2018-06-05T16:33:44.905-0400">2018-06-05T16:33:44.905-0400</relative-time></i></p>
                        <p>The&#160;LIMIT_UNEXPECTED_FILE error mentioned above was due to the fact that the upload element names used in the withCamera imageBlockEditor template (storyBlockImage-withCameraCapture.handlebars) were not handled by the Multer middleware.</p>
<p>The solution to this is to change the "name" fields for both upload elements in the template to "file".</p>
<p>Edit: solution implemented, seems to work when tested locally</p>

                    </li>
                    
                </ul>
            </div>
            
        </div>
    </div>

        </main>
        <footer>
            
<nav aria-labelledby="pagination">
    <h2 class="visually-hidden">pagination</h2>
    <p class="flex">
        
        
        <a class="mx-1" href="/browse/SJRK-98/"><span class="aria-hidden">←</span> Previous: SJRK-98</a>
        <a class="mx-1" href="/browse/SJRK-100/">Next: SJRK-100 <span class="aria-hidden">→</span></a>
    </p>
</nav>

        </footer>
    </body>
</html>