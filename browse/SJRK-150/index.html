<!DOCTYPE html>
<html lang="en" dir="ltr" data-color-scheme="light">
    <head>
        <title> SJRK-150  | Fluid Project Issues Archive</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <meta name="description" content="Archive of Fluid Project issues from the JIRA issue tracker">
        <meta property="og:title" content=" SJRK-150 |  Fluid Project Issues Archive">
        <meta property="og:description" content="Archive of Fluid Project issues">
        <meta property="og:locale" content="en">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://issues.fluidproject.org/browse/SJRK-150/">
        <link rel="canonical" href="https://issues.fluidproject.org/browse/SJRK-150/">


        <link rel="stylesheet" href="/assets/styles/style.css">

        
<script type="module" src="/assets/scripts/relative-time/bundle.js"></script>

    </head>
    <body class="page-issue">
        <header class="mt-3">
            <a class="skip-link" href="#main">Skip to Content</a>
            <nav aria-label="main menu">
                <menu>
                    <li><a rel="home" href="/">Home</a></li>
                    <li><a href="/search/">Search</a></li>
                </menu>
            </nav>
            
        <nav aria-label="breadcrumbs">
            <ol>
                <li><a rel="home" href="/">Home</a></li>
                <li><a href="/projects/SJRK" data-pagefind-filter="project">Social Justice Repair Kit</a></li>
                <li><a href="/browse/SJRK-150/">SJRK-150</a></li>
            </ol>
        </nav>
        <h1>SJRK-150: Update Edit page tests to work in any language</h1>

        </header>
        <main id="main">
            
    <div id="content" class="content with-sidebar">
        <div class="spacing-y-1 bg-default">
            <h2>Metadata</h2>
            <dl>
                <div>
                    <dt>Source</dt>
                    <dd><a href="https://fluidproject.atlassian.net/browse/SJRK-150">SJRK-150</a></dd>
                </div>
                <div>
                    <dt>Type</dt>
                    <dd>
                        <a href="/projects/SJRK/?type=Bug">Bug</a>
                    </dd>
                </div>
                <div>
                    <dt>Priority</dt>
                    <dd>Major</dd>
                </div>
                <div>
                    <dt>Status</dt>
                    <dd>Closed</dd>
                </div>
                <div>
                    <dt>Resolution</dt>
                    <dd>
                            <a href="/projects/SJRK/?resolution=Fixed">Fixed</a>
                        
                    </dd>
                </div>
                <div>
                    <dt>Assignee</dt>
                    <dd>N/A</dd>
                </div>
                <div>
                    <dt>Reporter</dt>
                    <dd>
                        <a href="/projects/SJRK/?reporter=Gregor%20Moss">Gregor Moss</a>
                    </dd>
                </div>
                <div>
                    <dt>Created</dt>
                    <dd><relative-time datetime="2018-06-11T01:53:04.151-0400" prefix="">2018-06-11T01:53:04.151-0400</relative-time></dd>
                </div>
                <div>
                    <dt>Updated</dt>
                    <dd><relative-time datetime="2018-06-28T19:07:04.650-0400" prefix="">2018-06-28T19:07:04.650-0400</relative-time></dd>
                </div>
                <div>
                    <dt>Versions</dt>
                    <dd>
                        
                        N/A
                        
                    </dd>
                </div>
                <div>
                    <dt>Fixed Versions</dt>
                    <dd>
                        
                        N/A
                        
                    </dd>
                </div>
                <div>
                    <dt>Component</dt>
                    <dd>
                        
                        <ol role="list">
                            
                            <li>Storytelling Tool UI</li>
                            
                        </ol>
                        
                    </dd>
                </div>
            </dl>
        </div>

        <div>
            <div class="spacing-y-1">
                <h2>Description</h2>
                <p>The tests for sjrk.storyTelling.page.storyEdit currently fail if they are run after the tests for sjrk.storyTelling.page, because the latter sets the language cookie to Spanish and the former expects values in English.</p>
<p>This is symptomatic of the message_readStoryText value containing set values in the given language, instead of being dynamically composed of other messages (like message_authorText). This can be tackled later.</p>
<p>A simple solution for the time being could be something like switching the language click tests on page to run English second instead of first, or calling something to clear the cookie at the end of the sequence.</p>

            </div>
            
            
            
            
            <div class="spacing-y-1">
                <h2>Comments</h2>
                <ul class="spacing-y-2" role="list">
                    
                    <li id="comment-26446">
                        <p class="mb-0"><b>Gregor Moss</b> <i>commented <relative-time datetime="2018-06-11T12:24:15.352-0400">2018-06-11T12:24:15.352-0400</relative-time></i></p>
                        <p>Fixed by switching the test order. This is not an ideal solution.</p>

                    </li>
                    
                    <li id="comment-26447">
                        <p class="mb-0"><b>Gregor Moss</b> <i>commented <relative-time datetime="2018-06-27T11:26:51.685-0400">2018-06-27T11:26:51.685-0400</relative-time></i></p>
                        <p>The tests for sjrk.storyTelling.page.storyEdit will fail if either:</p>
<ul>
<li>the cookie with language preferences is missing, or</li>
<li>the cookie is present and the language is not English</li>
</ul>
<p>Ensure the tests are set up such that they will pass, either by making sure the preference is there and set to English, or by adjusting precisely what is tested.</p>

                    </li>
                    
                    <li id="comment-26448">
                        <p class="mb-0"><b>Gregor Moss</b> <i>commented <relative-time datetime="2018-06-27T12:01:27.829-0400">2018-06-27T12:01:27.829-0400</relative-time></i></p>
                        <p>A related symptom is that if the cookie is not present while using the editor page, the first click of a block-add button will fail in exactly the way described in <a href="/browse/SJRK-94/">SJRK-94</a></p>
<p>Ergo it is likely that there is nothing wrong with the tests at all, and that the code for blockUi's should be made more robust in order to deal with just such a situation. The default initial value should be set somewhere and used instead of falling back to "undefined"</p>

                    </li>
                    
                    <li id="comment-26449">
                        <p class="mb-0"><b>Gregor Moss</b> <i>commented <relative-time datetime="2018-06-28T18:52:27.137-0400">2018-06-28T18:52:27.137-0400</relative-time></i></p>
                        <p>The solution was to update the page.model.uiLanguage to templateManager.model.locale relay to work only conditionally, so that if uiLanguage is falsy (e.g. undefined), then it simply doesn't override the default, which is "en"</p>

                    </li>
                    
                    <li id="comment-26450">
                        <p class="mb-0"><b>Gregor Moss</b> <i>commented <relative-time datetime="2018-06-28T19:07:04.647-0400">2018-06-28T19:07:04.647-0400</relative-time></i></p>
                        <p>The tests have been adjusted to work regardless of the initial language set, and now include checking that the text-to-speech string is changed and renders correctly when switched between English and Spanish and back again. As mentioned in the most recent comment, if there is no cookie present, the site will default to English.</p>

                    </li>
                    
                </ul>
            </div>
            
        </div>
    </div>

        </main>
        <footer>
            
<nav aria-labelledby="pagination">
    <h2 class="visually-hidden">pagination</h2>
    <p class="flex">
        
        
        <a class="mx-1" href="/browse/SJRK-149/"><span class="aria-hidden">←</span> Previous: SJRK-149</a>
        <a class="mx-1" href="/browse/SJRK-151/">Next: SJRK-151 <span class="aria-hidden">→</span></a>
    </p>
</nav>

        </footer>
    </body>
</html>