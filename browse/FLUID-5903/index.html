<!DOCTYPE html>
<html lang="en" dir="ltr" data-color-scheme="light">
    <head>
        <title> FLUID-5903  | Fluid Project Issues Archive</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <meta name="description" content="Archive of Fluid Project issues from the JIRA issue tracker">
        <meta property="og:title" content=" FLUID-5903 |  Fluid Project Issues Archive">
        <meta property="og:description" content="Archive of Fluid Project issues">
        <meta property="og:locale" content="en">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://issues.fluidproject.org/browse/FLUID-5903/">
        <link rel="canonical" href="https://issues.fluidproject.org/browse/FLUID-5903/">


        <link rel="stylesheet" href="/assets/styles/style.css">

        
<script type="module" src="/assets/scripts/relative-time/bundle.js"></script>

    </head>
    <body class="page-issue">
        <header class="mt-3">
            <a class="skip-link" href="#main">Skip to Content</a>
            <nav aria-label="main menu">
                <menu>
                    <li><a rel="home" href="/">Home</a></li>
                    <li><a href="/search/">Search</a></li>
                </menu>
            </nav>
            
        <nav aria-label="breadcrumbs">
            <ol>
                <li><a rel="home" href="/">Home</a></li>
                <li><a href="/projects/FLUID" data-pagefind-filter="project">Fluid Infusion</a></li>
                <li><a href="/browse/FLUID-5903/">FLUID-5903</a></li>
            </ol>
        </nav>
        <h1>FLUID-5903: Eliminate fragile sequence array-building code in IoC Testing Framework in favour of "grade constraint budding system"</h1>

        </header>
        <main id="main">
            
    <div id="content" class="content with-sidebar">
        <div class="spacing-y-1 bg-default">
            <h2>Metadata</h2>
            <dl>
                <div>
                    <dt>Source</dt>
                    <dd><a href="https://fluidproject.atlassian.net/browse/FLUID-5903">FLUID-5903</a></dd>
                </div>
                <div>
                    <dt>Type</dt>
                    <dd>
                        <a href="/projects/FLUID/?type=Improvement">Improvement</a>
                    </dd>
                </div>
                <div>
                    <dt>Priority</dt>
                    <dd>Major</dd>
                </div>
                <div>
                    <dt>Status</dt>
                    <dd>Closed</dd>
                </div>
                <div>
                    <dt>Resolution</dt>
                    <dd>
                            <a href="/projects/FLUID/?resolution=Fixed">Fixed</a>
                        
                    </dd>
                </div>
                <div>
                    <dt>Assignee</dt>
                    <dd>Antranig Basman</dd>
                </div>
                <div>
                    <dt>Reporter</dt>
                    <dd>
                        <a href="/projects/FLUID/?reporter=Antranig%20Basman">Antranig Basman</a>
                    </dd>
                </div>
                <div>
                    <dt>Created</dt>
                    <dd><relative-time datetime="2016-05-08T13:52:39.009-0400" prefix="">2016-05-08T13:52:39.009-0400</relative-time></dd>
                </div>
                <div>
                    <dt>Updated</dt>
                    <dd><relative-time datetime="2024-07-22T09:26:01.574-0400" prefix="">2024-07-22T09:26:01.574-0400</relative-time></dd>
                </div>
                <div>
                    <dt>Versions</dt>
                    <dd>
                        
                        N/A
                        
                    </dd>
                </div>
                <div>
                    <dt>Fixed Versions</dt>
                    <dd>
                        
                        <ol role="list">
                            
                            <li>2.0</li>
                            
                        </ol>
                        
                    </dd>
                </div>
                <div>
                    <dt>Component</dt>
                    <dd>
                        
                        <ol role="list">
                            
                            <li>IoC Testing Framework</li>
                            
                        </ol>
                        
                    </dd>
                </div>
            </dl>
        </div>

        <div>
            <div class="spacing-y-1">
                <h2>Description</h2>
                <p>Lots of code around the place struggles with the fact that whilst IoC Testing framework sequences, unlike promise chains, are "openly authorable", they are sadly only openly authorable in the most miserable form of plain arrays. For example, consider the following utility <code>gpii.test.express.helpers.addRequiredSequences</code> in gpii-express tests:</p>
<p><a href="https://github.com/GPII/gpii-express/blob/master/tests/js/lib/test-helpers.js#L138">https://github.com/GPII/gpii-express/blob/master/tests/js/lib/test-helpers.js#L138</a></p>
<p>or the more elaborate but still ultimately wrong-headed array bashing code in the GPII CloudBased OAuth2 tests' "buildDisruptedFixture"</p>
<p><a href="https://github.com/GPII/universal/blob/master/gpii/node_modules/testing/src/CloudBasedOAuth2.js#L536">https://github.com/GPII/universal/blob/master/gpii/node_modules/testing/src/CloudBasedOAuth2.js#L536</a></p>
<p>Another such "epicycle" is our support for fluid.flatten() applied to these arrays which at least does the courtesy of allowing them to be built up as "arrays of arrays" (but still, ultimately, not to be addressed in a usable and stable way).</p>
<p>This infrastructure fails to deliver on our core values - that of supporting open authorship in an unbounded community. We need to move to a system which allows time-points in testing sequences to be addressed as stable landmarks - very similar to all the other systems that fall under our <a href="http://docs.fluidproject.org/infusion/development/Priorities.html">http://docs.fluidproject.org/infusion/development/Priorities.html</a> system (which did not exist at the time the IoC Testing framework was designed).</p>
<p>This use case might not in the end be more difficult than any of the others we have so far tackled. We need to support "sequence inheritance" in which the sequence itself is directly represented as a GRADE. Sequence blocks (short arrays) can be assigned namespaces and namespace-based priorities, and the inheritance process will then allow refined blocks to interleave themselves at arbitrarily chosen and stably identifiable points in between the sequence blocks of parent grades. This will be somewhat similar to the "transforming promise chain" approach.</p>
<p>One advanced capability we would like would be to ingest an entire block produced by a parent grade and replace it with a processed instance. This requires highly advanced control over mergePolicies - see ideas on "local mergePolicy" aired in IRC on <a href="https://botbot.me/freenode/fluid-work/2015-09-11/?msg=49513398&page=1">https://botbot.me/freenode/fluid-work/2015-09-11/?msg=49513398&amp;page=1</a> required for <a href="/browse/FLUID-4982/">FLUID-4982</a>. </p>

            </div>
            
            
            
            
            <div class="spacing-y-1">
                <h2>Comments</h2>
                <ul class="spacing-y-2" role="list">
                    
                    <li id="comment-25475">
                        <p class="mb-0"><b>Cindy Li</b> <i>commented <relative-time datetime="2016-10-24T16:00:03.849-0400">2016-10-24T16:00:03.849-0400</relative-time></i></p>
                        <p>The pull request for the infusion implementation <a href="https://github.com/fluid-project/infusion/pull/755">https://github.com/fluid-project/infusion/pull/755</a> has been merged at ff72b53d80c2c11c360e57e8f62e50dbca337875</p>
<p>The corresponding documentation update is still needed.</p>

                    </li>
                    
                    <li id="comment-25476">
                        <p class="mb-0"><b>Antranig Basman</b> <i>commented <relative-time datetime="2016-12-18T21:47:02.035-0500">2016-12-18T21:47:02.035-0500</relative-time></i></p>
                        <p>Some meeting notes where this feature was presented and discussed have been wikified at <a href="https://wiki.fluidproject.org/display/fluid/Motivation+and+Explanation+for+New+IoC+Testing+Framework+Feature+sequenceGrade">https://wiki.fluidproject.org/display/fluid/Motivation+and+Explanation+for+New+IoC+Testing+Framework+Feature+sequenceGrade</a></p>

                    </li>
                    
                    <li id="comment-25477">
                        <p class="mb-0"><b>Justin Obara</b> <i>commented <relative-time datetime="2017-02-02T12:40:14.868-0500">2017-02-02T12:40:14.868-0500</relative-time></i></p>
                        <p>Merged PR ( <a href="https://github.com/fluid-project/infusion-docs/pull/103">https://github.com/fluid-project/infusion-docs/pull/103</a> ) into the docs repo.<br>
merged into master @ bde03ec4685861428fdee5a53f254038298ab162<br>
merged into 2.x.x @ 67929cb89c8a33d428d905b65436c6d729dcf135</p>

                    </li>
                    
                </ul>
            </div>
            
        </div>
    </div>

        </main>
        <footer>
            
<nav aria-labelledby="pagination">
    <h2 class="visually-hidden">pagination</h2>
    <p class="flex">
        
        
        <a class="mx-1" href="/browse/FLUID-5902/"><span class="aria-hidden">←</span> Previous: FLUID-5902</a>
        <a class="mx-1" href="/browse/FLUID-5904/">Next: FLUID-5904 <span class="aria-hidden">→</span></a>
    </p>
</nav>

        </footer>
    </body>
</html>