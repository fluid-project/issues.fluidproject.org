<!DOCTYPE html>
<html lang="en" dir="ltr" data-color-scheme="light">
    <head>
        <title> KETTLE-46  | Fluid Project Issues Archive</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <meta name="description" content="Archive of Fluid Project issues from the JIRA issue tracker">
        <meta property="og:title" content=" KETTLE-46 |  Fluid Project Issues Archive">
        <meta property="og:description" content="Archive of Fluid Project issues">
        <meta property="og:locale" content="en">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://issues.fluidproject.org/browse/KETTLE-46/">
        <link rel="canonical" href="https://issues.fluidproject.org/browse/KETTLE-46/">


        <link rel="stylesheet" href="/assets/styles/style.css">

        
<script type="module" src="/assets/scripts/relative-time/bundle.js"></script>

    </head>
    <body class="page-issue">
        <header class="mt-3">
            <a class="skip-link" href="#main">Skip to Content</a>
            <nav aria-label="main menu">
                <menu>
                    <li><a rel="home" href="/">Home</a></li>
                    <li><a href="/search/">Search</a></li>
                </menu>
            </nav>
            
        <nav aria-label="breadcrumbs">
            <ol>
                <li><a rel="home" href="/">Home</a></li>
                <li><a href="/projects/KETTLE" data-pagefind-filter="project">Kettle</a></li>
                <li><a href="/browse/KETTLE-46/">KETTLE-46</a></li>
            </ol>
        </nav>
        <h1>KETTLE-46: Isolate kettle.dataSource.URL for ease of reuse on the client-side....</h1>

        </header>
        <main id="main">
            
    <div id="content" class="content with-sidebar">
        <div class="spacing-y-1 bg-default">
            <h2>Metadata</h2>
            <dl>
                <div>
                    <dt>Source</dt>
                    <dd><a href="https://fluidproject.atlassian.net/browse/KETTLE-46">KETTLE-46</a></dd>
                </div>
                <div>
                    <dt>Type</dt>
                    <dd>
                        <a href="/projects/KETTLE/?type=Improvement">Improvement</a>
                    </dd>
                </div>
                <div>
                    <dt>Priority</dt>
                    <dd>Major</dd>
                </div>
                <div>
                    <dt>Status</dt>
                    <dd>Closed</dd>
                </div>
                <div>
                    <dt>Resolution</dt>
                    <dd>
                            <a href="/projects/KETTLE/?resolution=Fixed">Fixed</a>
                        
                    </dd>
                </div>
                <div>
                    <dt>Assignee</dt>
                    <dd>Antranig Basman</dd>
                </div>
                <div>
                    <dt>Reporter</dt>
                    <dd>
                        <a href="/projects/KETTLE/?reporter=Tony%20Atkins%20%5BRtF%5D">Tony Atkins [RtF]</a>
                    </dd>
                </div>
                <div>
                    <dt>Created</dt>
                    <dd><relative-time datetime="2016-07-05T05:31:39.346-0400" prefix="">2016-07-05T05:31:39.346-0400</relative-time></dd>
                </div>
                <div>
                    <dt>Updated</dt>
                    <dd><relative-time datetime="2016-08-30T10:06:52.110-0400" prefix="">2016-08-30T10:06:52.110-0400</relative-time></dd>
                </div>
                <div>
                    <dt>Versions</dt>
                    <dd>
                        
                        N/A
                        
                    </dd>
                </div>
                <div>
                    <dt>Fixed Versions</dt>
                    <dd>
                        
                        N/A
                        
                    </dd>
                </div>
                <div>
                    <dt>Component</dt>
                    <dd>
                        
                        N/A
                        
                    </dd>
                </div>
            </dl>
        </div>

        <div>
            <div class="spacing-y-1">
                <h2>Description</h2>
                <p>Currently, the node-unique dataSource components live in one file, with the browser-safe components in another file.</p>
<p>To make it possible to use <code>kettle.dataSource.URL</code> with <code>browserify</code> (see <a href="https://issues.gpii.net/browse/GPII-1587">GPII-1587</a>), we should further compartmentalize the pieces that can only ever run on node (such as the dataSources that use the "fs" module) from things like kettle.dataSource.URL, which can conceivably be run in the browser using browserify.</p>
<p>This spike would not add client-side tests, it would only confirm that all tests pass once the code is reorganized.  To preserve support for references to the old structure used in calls like <code>fluid.require("%kettle/lib/dataSource-node.js");}, I plan to require the new file from within {{dataSource-node.js</code>.</p>
<p>cc: Antranig Basman</p>

            </div>
            
            
            
            
            <div class="spacing-y-1">
                <h2>Comments</h2>
                <ul class="spacing-y-2" role="list">
                    
                    <li id="comment-26099">
                        <p class="mb-0"><b>Tony Atkins [RtF]</b> <i>commented <relative-time datetime="2016-07-05T05:48:05.842-0400">2016-07-05T05:48:05.842-0400</relative-time></i></p>
                        <p><a href="https://github.com/fluid-project/kettle/pull/24">https://github.com/fluid-project/kettle/pull/24</a></p>

                    </li>
                    
                    <li id="comment-26100">
                        <p class="mb-0"><b>Tony Atkins [RtF]</b> <i>commented <relative-time datetime="2016-07-05T05:51:08.223-0400">2016-07-05T05:51:08.223-0400</relative-time></i></p>
                        <p>I have made the minimum changes to enable proof-of-concept work in using <code>kettle.dataSource.URL</code> in-browser.  All tests pass and the change does not affect the level of code coverage.</p>
<p>We need to have a larger discussion around where data sources should live, for now I will write the initial browser tests for kettle.dataSource.URL in the UL API repo.</p>

                    </li>
                    
                    <li id="comment-26101">
                        <p class="mb-0"><b>Tony Atkins [RtF]</b> <i>commented <relative-time datetime="2016-07-05T08:30:28.573-0400">2016-07-05T08:30:28.573-0400</relative-time></i></p>
                        <p>I have discovered that jsonlint has a different structure when called from node, basically it wires itself in as the parser when it's used from CommonJS.  Kettle expects to find jsonlint.parser, which doesn't exist on the browser side.  The workaround (which we should review) is simply to set <code>jsonlint.parser = jsonlint</code></p>
<p>I also discovered that the implementation of <code>kettle.dataSource.URL</code> relies on the node-side <code>kettle.wrapCallback</code> function:</p>
<p><a href="https://github.com/fluid-project/kettle/blob/9fdef26a796eaab5dd1f531a940f08f3d7761912/lib/KettleRequest.js#L91">https://github.com/fluid-project/kettle/blob/9fdef26a796eaab5dd1f531a940f08f3d7761912/lib/KettleRequest.js#L91</a><br>
<a href="https://github.com/fluid-project/kettle/blob/9fdef26a796eaab5dd1f531a940f08f3d7761912/lib/dataSource-node.js#L313">https://github.com/fluid-project/kettle/blob/9fdef26a796eaab5dd1f531a940f08f3d7761912/lib/dataSource-node.js#L313</a></p>
<p>I will create a workaround for that as well until we can discuss further.</p>

                    </li>
                    
                    <li id="comment-26102">
                        <p class="mb-0"><b>Tony Atkins [RtF]</b> <i>commented <relative-time datetime="2016-08-30T10:06:52.079-0400">2016-08-30T10:06:52.079-0400</relative-time></i></p>
                        <p>Happy to see this one closed, as we agreed, we need a parallel implementation backed by jQuery.</p>

                    </li>
                    
                </ul>
            </div>
            
        </div>
    </div>

        </main>
        <footer>
            
<nav aria-labelledby="pagination">
    <h2 class="visually-hidden">pagination</h2>
    <p class="flex">
        
        
        <a class="mx-1" href="/browse/KETTLE-45/"><span class="aria-hidden">←</span> Previous: KETTLE-45</a>
        <a class="mx-1" href="/browse/KETTLE-48/">Next: KETTLE-48 <span class="aria-hidden">→</span></a>
    </p>
</nav>

        </footer>
    </body>
</html>