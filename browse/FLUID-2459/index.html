<!DOCTYPE html>
<html lang="en" dir="ltr" data-color-scheme="light">
    <head>
        <title> FLUID-2459  | Fluid Project Issues Archive</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <meta name="description" content="Archive of Fluid Project issues from the JIRA issue tracker">
        <meta property="og:title" content=" FLUID-2459 |  Fluid Project Issues Archive">
        <meta property="og:description" content="Archive of Fluid Project issues">
        <meta property="og:locale" content="en">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://issues.fluidproject.org/browse/FLUID-2459/">
        <link rel="canonical" href="https://issues.fluidproject.org/browse/FLUID-2459/">


        <link rel="stylesheet" href="/assets/styles/style.css">

        
<script type="module" src="/assets/scripts/relative-time/bundle.js"></script>

    </head>
    <body class="page-issue">
        <header class="mt-3">
            <a class="skip-link" href="#main">Skip to Content</a>
            <nav aria-label="main menu">
                <menu>
                    <li><a rel="home" href="/">Home</a></li>
                    <li><a href="/search/">Search</a></li>
                </menu>
            </nav>
            
        <nav aria-label="breadcrumbs">
            <ol>
                <li><a rel="home" href="/">Home</a></li>
                <li><a href="/projects/FLUID" data-pagefind-filter="project">Fluid Infusion</a></li>
                <li><a href="/browse/FLUID-2459/">FLUID-2459</a></li>
            </ol>
        </nav>
        <h1>FLUID-2459: Removing files from the file queue throws an error</h1>

        </header>
        <main id="main">
            
    <div id="content" class="content with-sidebar">
        <div class="spacing-y-1 bg-default">
            <h2>Metadata</h2>
            <dl>
                <div>
                    <dt>Source</dt>
                    <dd><a href="https://fluidproject.atlassian.net/browse/FLUID-2459">FLUID-2459</a></dd>
                </div>
                <div>
                    <dt>Type</dt>
                    <dd>
                        <a href="/projects/FLUID/?type=Sub-issue">Sub-issue</a>
                    </dd>
                </div>
                <div>
                    <dt>Priority</dt>
                    <dd>Blocker</dd>
                </div>
                <div>
                    <dt>Status</dt>
                    <dd>Closed</dd>
                </div>
                <div>
                    <dt>Resolution</dt>
                    <dd>
                            <a href="/projects/FLUID/?resolution=Fixed">Fixed</a>
                        
                    </dd>
                </div>
                <div>
                    <dt>Assignee</dt>
                    <dd>Eli Cochran</dd>
                </div>
                <div>
                    <dt>Reporter</dt>
                    <dd>
                        <a href="/projects/FLUID/?reporter=Justin%20Obara">Justin Obara</a>
                    </dd>
                </div>
                <div>
                    <dt>Created</dt>
                    <dd><relative-time datetime="2009-04-01T16:13:48.000-0400" prefix="">2009-04-01T16:13:48.000-0400</relative-time></dd>
                </div>
                <div>
                    <dt>Updated</dt>
                    <dd><relative-time datetime="2009-04-07T16:10:12.000-0400" prefix="">2009-04-07T16:10:12.000-0400</relative-time></dd>
                </div>
                <div>
                    <dt>Versions</dt>
                    <dd>
                        
                        N/A
                        
                    </dd>
                </div>
                <div>
                    <dt>Fixed Versions</dt>
                    <dd>
                        
                        <ol role="list">
                            
                            <li>1.0</li>
                            
                        </ol>
                        
                    </dd>
                </div>
                <div>
                    <dt>Component</dt>
                    <dd>
                        
                        <ol role="list">
                            
                            <li>Uploader</li>
                            
                        </ol>
                        
                    </dd>
                </div>
            </dl>
        </div>

        <div>
            <div class="spacing-y-1">
                <h2>Description</h2>
                <p>Removing files from the file queue throws an error</p>
<p>Steps to reproduce:</p>
<p>1) Open either the server or the demo version of uploader<br>
<a href="http://build.fluidproject.org/infusion/components/uploader/html/Uploader.html">http://build.fluidproject.org/infusion/components/uploader/html/Uploader.html</a><br>
<a href="http://build.fluidproject.org:8080/sakai-imagegallery2-web/site/BrowseImages/">http://build.fluidproject.org:8080/sakai-imagegallery2-web/site/BrowseImages/</a></p>
<p>2) Add files to the file queue</p>
<p>3) Remove a file from the file queue</p>
<p>Notice that an error is thrown</p>
<p>Error: that.queue.currentBatch is undefined<br>
File: SWFUploadManager.js<br>
Line: 292</p>

            </div>
            
            
            
            <div class="spacing-y-1">
                <h2>Attachments</h2>
                <ul class="spacing-y-1" role="list">
                    
                    <li>
                        <a href="https://idrc.cachefly.net/issues.fluidproject.org/FLUID/FLUID-2459/FLUID-2459.a.patch">
                            
                                FLUID-2459.a.patch
                            
                        </a>
                    </li>
                    
                </ul>
            </div>
            
            
            <div class="spacing-y-1">
                <h2>Comments</h2>
                <ul class="spacing-y-2" role="list">
                    
                    <li id="comment-21375">
                        <p class="mb-0"><b>Eli Cochran</b> <i>commented <relative-time datetime="2009-04-01T20:35:41.000-0400">2009-04-01T20:35:41.000-0400</relative-time></i></p>
                        <p>Interesting bug. Pretty sure that the fix is to move the offending line (292): </p>
<p>that.queue.currentBatch.totalBytesUploaded += file.size;</p>
<p>inside the else clause so the method becomes:</p>
<p>that.events.onFileError.addListener(function (file, error) {<br>
if (error === fluid.uploader.errorConstants.UPLOAD_STOPPED) {<br>
that.queue.isUploading = false;<br>
} else if (that.queue.isUploading) {<br>
that.queue.currentBatch.totalBytesUploaded += file.size;<br>
that.queue.currentBatch.numFilesErrored++;<br>
}<br>
fileStatusUpdater(file);<br>
});</p>
<p>However, I'm going to sleep on it. </p>

                    </li>
                    
                    <li id="comment-21376">
                        <p class="mb-0"><b>Justin Obara</b> <i>commented <relative-time datetime="2009-04-02T08:52:30.000-0400">2009-04-02T08:52:30.000-0400</relative-time></i></p>
                        <p>Not sure if this will help or not, but the error doesn't occur if the upload button has been pressed. So if you start and stop an upload or let it complete and then add more files, removing files from the queue won't throw the error.</p>

                    </li>
                    
                    <li id="comment-21377">
                        <p class="mb-0"><b>Justin Obara</b> <i>commented <relative-time datetime="2009-04-02T14:53:42.000-0400">2009-04-02T14:53:42.000-0400</relative-time></i></p>
                        <p>Will require a full set of QA tests after it is resolved.</p>

                    </li>
                    
                    <li id="comment-21378">
                        <p class="mb-0"><b>Eli Cochran</b> <i>commented <relative-time datetime="2009-04-03T12:56:16.000-0400">2009-04-03T12:56:16.000-0400</relative-time></i></p>
                        <p>The <a href="/browse/FLUID-2459/">FLUID-2459</a>.a.patch is exactly the fix outlined above. Tested on the server and demo versions. </p>

                    </li>
                    
                    <li id="comment-21379">
                        <p class="mb-0"><b>Colin Clark</b> <i>commented <relative-time datetime="2009-04-03T17:34:41.000-0400">2009-04-03T17:34:41.000-0400</relative-time></i></p>
                        <p>I have reviewed Eli's patch and it is correct. I tested it on the following platforms and it checks out:</p>
<p>Demo Uploader<br>
Mac OS X: FF 2, Safari 4 beta<br>
Windows: FF 2, IE 7</p>
<p>I'm having trouble with my server version, so perhaps someone else can give it a try?</p>

                    </li>
                    
                    <li id="comment-21380">
                        <p class="mb-0"><b>Eli Cochran</b> <i>commented <relative-time datetime="2009-04-03T18:03:04.000-0400">2009-04-03T18:03:04.000-0400</relative-time></i></p>
                        <p>I ran it on my local server and it worked well... but then I wrote the patch so I don't count. üòâ</p>

                    </li>
                    
                    <li id="comment-21381">
                        <p class="mb-0"><b>Colin Clark</b> <i>commented <relative-time datetime="2009-04-06T14:48:06.000-0400">2009-04-06T14:48:06.000-0400</relative-time></i></p>
                        <p>I've since tested it on a server build and it's working great. +1 for including this in 1.0</p>

                    </li>
                    
                    <li id="comment-21382">
                        <p class="mb-0"><b>Justin Obara</b> <i>commented <relative-time datetime="2009-04-07T16:10:12.000-0400">2009-04-07T16:10:12.000-0400</relative-time></i></p>
                        <p>Verified fix using:</p>
<p>FF2, FF3, Opera 9.6, Safari 3.2 (Mac OS 10.5)<br>
Safari 3.2 (Mac OS 10.4)<br>
FF2, FF3, IE6, IE7, Opera 9.6 (Win XP)<br>
FF3, IE7 (Win Vista)<br>
IE6 (Win 2000)</p>

                    </li>
                    
                </ul>
            </div>
            
        </div>
    </div>

        </main>
        <footer>
            
<nav aria-labelledby="pagination">
    <h2 class="visually-hidden">pagination</h2>
    <p class="flex">
        
        
        <a class="mx-1" href="/browse/FLUID-2458/"><span class="aria-hidden">‚Üê</span> Previous: FLUID-2458</a>
        <a class="mx-1" href="/browse/FLUID-2460/">Next: FLUID-2460 <span class="aria-hidden">‚Üí</span></a>
    </p>
</nav>

        </footer>
    </body>
</html>