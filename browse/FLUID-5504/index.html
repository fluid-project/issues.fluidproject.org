<!DOCTYPE html>
<html lang="en" dir="ltr" data-color-scheme="light">
    <head>
        <title> FLUID-5504  | Fluid Project Issues Archive</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <meta name="description" content="Archive of Fluid Project issues from the JIRA issue tracker">
        <meta property="og:title" content=" FLUID-5504 |  Fluid Project Issues Archive">
        <meta property="og:description" content="Archive of Fluid Project issues">
        <meta property="og:locale" content="en">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://issues.fluidproject.org/browse/FLUID-5504/">
        <link rel="canonical" href="https://issues.fluidproject.org/browse/FLUID-5504/">


        <link rel="stylesheet" href="/assets/styles/style.css">

        
<script type="module" src="/assets/scripts/relative-time/bundle.js"></script>

    </head>
    <body class="page-issue">
        <header class="mt-3">
            <a class="skip-link" href="#main">Skip to Content</a>
            <nav aria-label="main menu">
                <menu>
                    <li><a rel="home" href="/">Home</a></li>
                    <li><a href="/search/">Search</a></li>
                </menu>
            </nav>
            
        <nav aria-label="breadcrumbs">
            <ol>
                <li><a rel="home" href="/">Home</a></li>
                <li><a href="/projects/FLUID" data-pagefind-filter="project">Fluid Infusion</a></li>
                <li><a href="/browse/FLUID-5504/">FLUID-5504</a></li>
            </ol>
        </nav>
        <h1>FLUID-5504: Model relay registration triggered by listener registration causes failure</h1>

        </header>
        <main id="main">
            
    <div id="content" class="content with-sidebar">
        <div class="spacing-y-1 bg-default">
            <h2>Metadata</h2>
            <dl>
                <div>
                    <dt>Source</dt>
                    <dd><a href="https://fluidproject.atlassian.net/browse/FLUID-5504">FLUID-5504</a></dd>
                </div>
                <div>
                    <dt>Type</dt>
                    <dd>
                        <a href="/projects/FLUID/?type=Bug">Bug</a>
                    </dd>
                </div>
                <div>
                    <dt>Priority</dt>
                    <dd>Major</dd>
                </div>
                <div>
                    <dt>Status</dt>
                    <dd>Closed</dd>
                </div>
                <div>
                    <dt>Resolution</dt>
                    <dd>
                            <a href="/projects/FLUID/?resolution=Fixed">Fixed</a>
                        
                    </dd>
                </div>
                <div>
                    <dt>Assignee</dt>
                    <dd>Antranig Basman</dd>
                </div>
                <div>
                    <dt>Reporter</dt>
                    <dd>
                        <a href="/projects/FLUID/?reporter=Antranig%20Basman">Antranig Basman</a>
                    </dd>
                </div>
                <div>
                    <dt>Created</dt>
                    <dd><relative-time datetime="2014-09-03T15:26:07.623-0400" prefix="">2014-09-03T15:26:07.623-0400</relative-time></dd>
                </div>
                <div>
                    <dt>Updated</dt>
                    <dd><relative-time datetime="2020-07-30T07:42:48.477-0400" prefix="">2020-07-30T07:42:48.477-0400</relative-time></dd>
                </div>
                <div>
                    <dt>Versions</dt>
                    <dd>
                        
                        N/A
                        
                    </dd>
                </div>
                <div>
                    <dt>Fixed Versions</dt>
                    <dd>
                        
                        <ol role="list">
                            
                            <li>1.9</li>
                            
                        </ol>
                        
                    </dd>
                </div>
                <div>
                    <dt>Component</dt>
                    <dd>
                        
                        <ol role="list">
                            
                            <li>Data Binder</li>
                            
                            <li>IoC System</li>
                            
                        </ol>
                        
                    </dd>
                </div>
            </dl>
        </div>

        <div>
            <div class="spacing-y-1">
                <h2>Description</h2>
                <p>The following setup:</p>
<pre><code class="hljs language-java">fluid.defaults(<span class="hljs-string">"flock.enviro"</span>, {
        gradeNames: [<span class="hljs-string">"fluid.standardRelayComponent"</span>, <span class="hljs-string">"flock.nodeList"</span>, <span class="hljs-string">"autoInit"</span>],
....
        listeners: {
            onPlay: <span class="hljs-string">"{audioStrategy}.startGeneratingSamples()"</span>,
....
        components: {

            audioStrategy: {
                type: <span class="hljs-string">"flock.audioStrategy.platform"</span>,
                options: {
                    model: {
                        playState: <span class="hljs-string">"{enviro}.model.playState"</span>
                    }
                }
            }
</code></pre>
<p>where audioStrategy has</p>
<pre><code class="hljs language-java">invokers: {
            startGeneratingSamples: {
                funcName: <span class="hljs-string">"flock.audioStrategy.web.start"</span>,
                args: [<span class="hljs-string">"{that}.model"</span>, ....
</code></pre>
<p>causes a failure, DataBinding.js line 453 during</p>
<pre><code class="hljs language-java"><span class="hljs-type">var</span> <span class="hljs-variable">targetApplier</span> <span class="hljs-operator">=</span> options.targetApplier || target.applier; <span class="hljs-comment">// implies the target is a relay document</span>
        <span class="hljs-type">var</span> <span class="hljs-variable">sourceApplier</span> <span class="hljs-operator">=</span> options.sourceApplier || source.applier; <span class="hljs-comment">// implies the source is a relay document - listener will be transactional</span>
        <span class="hljs-type">var</span> <span class="hljs-variable">applierId</span> <span class="hljs-operator">=</span> targetApplier.applierId;
</code></pre>
<p>The workflow is - </p>
<p>i) initialisation of enviro reaches "registerListeners" - this observes its child, audioStrategy, and then observes that it has a model section which requires relay to the parent. This then binds ungingerly onto the parent's model and discovers that the applier is absent - since the "last-ditch" construction point is actually during enviro's initDependents which is far in the future. We should fix this simply by making sure that relay performs ginger observation of target's applier before use.</p>

            </div>
            
            
            
            
            <div class="spacing-y-1">
                <h2>Comments</h2>
                <ul class="spacing-y-2" role="list">
                    
                    <li id="comment-25372">
                        <p class="mb-0"><b>Colin Clark</b> <i>commented <relative-time datetime="2014-09-13T14:02:36.732-0400">2014-09-13T14:02:36.732-0400</relative-time></i></p>
                        <p>Reviewed, tested and merged.</p>

                    </li>
                    
                    <li id="comment-25373">
                        <p class="mb-0"><b>Justin Obara</b> <i>commented <relative-time datetime="2015-06-26T09:51:06.457-0400">2015-06-26T09:51:06.457-0400</relative-time></i></p>
                        <p>Reopening to change the fix version to 1.9</p>

                    </li>
                    
                </ul>
            </div>
            
        </div>
    </div>

        </main>
        <footer>
            
<nav aria-labelledby="pagination">
    <h2 class="visually-hidden">pagination</h2>
    <p class="flex">
        
        
        <a class="mx-1" href="/browse/FLUID-5503/"><span class="aria-hidden">←</span> Previous: FLUID-5503</a>
        <a class="mx-1" href="/browse/FLUID-5506/">Next: FLUID-5506 <span class="aria-hidden">→</span></a>
    </p>
</nav>

        </footer>
    </body>
</html>