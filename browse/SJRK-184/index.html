<!DOCTYPE html>
<html lang="en" dir="ltr" data-color-scheme="light">
    <head>
        <title> SJRK-184  | Fluid Project Issues Archive</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <meta name="description" content="Archive of Fluid Project issues from the JIRA issue tracker">
        <meta property="og:title" content=" SJRK-184 |  Fluid Project Issues Archive">
        <meta property="og:description" content="Archive of Fluid Project issues">
        <meta property="og:locale" content="en">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://issues.fluidproject.org/browse/SJRK-184/">
        <link rel="canonical" href="https://issues.fluidproject.org/browse/SJRK-184/">


        <link rel="stylesheet" href="/assets/styles/style.css">

        
<script type="module" src="/assets/scripts/relative-time/bundle.js"></script>

    </head>
    <body class="page-issue">
        <header class="mt-3">
            <a class="skip-link" href="#main">Skip to Content</a>
            <nav aria-label="main menu">
                <menu>
                    <li><a rel="home" href="/">Home</a></li>
                    <li><a href="/search/">Search</a></li>
                </menu>
            </nav>
            
        <nav aria-label="breadcrumbs">
            <ol>
                <li><a rel="home" href="/">Home</a></li>
                <li><a href="/projects/SJRK" data-pagefind-filter="project">Social Justice Repair Kit</a></li>
                <li><a href="/browse/SJRK-184/">SJRK-184</a></li>
            </ol>
        </nav>
        <h1>SJRK-184: Captured images are duplicated on iOS</h1>

        </header>
        <main id="main">
            
    <div id="content" class="content with-sidebar">
        <div class="spacing-y-1 bg-default">
            <h2>Metadata</h2>
            <dl>
                <div>
                    <dt>Source</dt>
                    <dd><a href="https://fluidproject.atlassian.net/browse/SJRK-184">SJRK-184</a></dd>
                </div>
                <div>
                    <dt>Type</dt>
                    <dd>
                        <a href="/projects/SJRK/?type=Bug">Bug</a>
                    </dd>
                </div>
                <div>
                    <dt>Priority</dt>
                    <dd>Critical</dd>
                </div>
                <div>
                    <dt>Status</dt>
                    <dd>Closed</dd>
                </div>
                <div>
                    <dt>Resolution</dt>
                    <dd>
                            <a href="/projects/SJRK/?resolution=Fixed">Fixed</a>
                        
                    </dd>
                </div>
                <div>
                    <dt>Assignee</dt>
                    <dd>Gregor Moss</dd>
                </div>
                <div>
                    <dt>Reporter</dt>
                    <dd>
                        <a href="/projects/SJRK/?reporter=Gregor%20Moss">Gregor Moss</a>
                    </dd>
                </div>
                <div>
                    <dt>Created</dt>
                    <dd><relative-time datetime="2019-01-17T23:07:48.444-0500" prefix="">2019-01-17T23:07:48.444-0500</relative-time></dd>
                </div>
                <div>
                    <dt>Updated</dt>
                    <dd><relative-time datetime="2020-12-13T21:01:33.263-0500" prefix="">2020-12-13T21:01:33.263-0500</relative-time></dd>
                </div>
                <div>
                    <dt>Versions</dt>
                    <dd>
                        
                        N/A
                        
                    </dd>
                </div>
                <div>
                    <dt>Fixed Versions</dt>
                    <dd>
                        
                        <ol role="list">
                            
                            <li>0.4</li>
                            
                        </ol>
                        
                    </dd>
                </div>
                <div>
                    <dt>Component</dt>
                    <dd>
                        
                        <ol role="list">
                            
                            <li>Storytelling Tool Server</li>
                            
                            <li>Storytelling Tool UI</li>
                            
                        </ol>
                        
                    </dd>
                </div>
            </dl>
        </div>

        <div>
            <div class="spacing-y-1">
                <h2>Description</h2>
                <p>When attempting to publish a story from certain iOS devices, if there is more than one image block and the images are captured, all subsequent captured image blocks will have their image replaced by the first one. This has been tested with two and four images, and has been reliably reproduced on that device several times. The image blocks all have the URL of the first saved file, so it seems they aren't being treated as separately-uploaded image files.</p>
<p>This is not an issue when the images are all from the photo library and already saved on the device, it only manifests itself when the images are captured from the camera directly into the image block.</p>
<hr>
<p>This works properly and as expected on:</p>
<ul>
<li>Pixel 3 (Android 9), Chrome 71</li>
<li>Nexus 7 (2012), Chrome 71</li>
<li>emulated Nexus 5X (Android 8.1), Chrome 61</li>
</ul>
<p>This issue has been confirmed and reproduced on:</p>
<ul>
<li>iPad Mini 2 running iOS 12.1.1</li>
<li>iPad Air 2 running iOS 12.1.1</li>
<li>iPad 2 running iOS 9.3.5</li>
</ul>
<hr>
<p><strong>To reproduce:</strong></p>
<ul>
<li>Begin a new story</li>
<li>Add an image block</li>
<li>Capture an image (not upload from Photo Library)</li>
<li>Add another image block</li>
<li>Capture a different image</li>
<li>Click "Continue"</li>
<li>Click "Preview My Story"</li>
<li>Click "Publish My Story"</li>
</ul>
<p><strong>Expect:</strong></p>
<ul>
<li>Both images on the resulting published story to be different</li>
</ul>
<p><strong>Actual:</strong></p>
<ul>
<li>Both images on the resulting published story are identical, and have the same file URL</li>
</ul>

            </div>
            
            
            
            
            <div class="spacing-y-1">
                <h2>Comments</h2>
                <ul class="spacing-y-2" role="list">
                    
                    <li id="comment-26369">
                        <p class="mb-0"><b>Gregor Moss</b> <i>commented <relative-time datetime="2019-01-22T15:27:54.752-0500">2019-01-22T15:27:54.752-0500</relative-time></i></p>
                        <p>I read up about possible causes of iOS capture behaviour, but couldn't pinpoint a particular cause. I tried to remotely debug the website on the iPad, but this yielded no results, I suspect the issue may be within Safari itself and its handling of multiple captured images.</p>
<p>I found some posts online suggesting that a file-type input in iOS with capture="camera" will not allow the "multiple" attribute and capturing from the camera at the same time. Given this attribute, iOS will only offer the option to upload multiple photos from the file system and not to capture any from the camera. Though this is different from our situation&#160;— uploading multiple single captured images&#160;— perhaps the cause is the same and iOS's restriction on multiple uploads from one file input is a workaround for that particular case.</p>

                    </li>
                    
                    <li id="comment-26370">
                        <p class="mb-0"><b>Simon Bates</b> <i>commented <relative-time datetime="2019-01-23T15:38:18.745-0500">2019-01-23T15:38:18.745-0500</relative-time></i></p>
                        <p>I have a theory that would explain this behaviour.</p>
<p>When we publish a story, the server request handler processes through each content block. And for blocks with associated files, including images, we match the block to the associated uploaded file and rename the file in the block, to the name that it will be served with by the server.</p>
<p>The matching is done by filename – just the filename, without any path information – such as <code>image.jpeg</code>.</p>
<p><a href="https://github.com/fluid-project/sjrk-story-telling-server/blob/b22a0b39ae517abee8c184f73c7ad92218e60f48/src/js/requestHandlers.js#L142">https://github.com/fluid-project/sjrk-story-telling-server/blob/b22a0b39ae517abee8c184f73c7ad92218e60f48/src/js/requestHandlers.js#L142</a></p>
<p>Now, if we had multiple uploaded files with the same name (such as <code>capture.jpeg</code> say), we would experience the behaviour outlined in this JIRA – all the blocks would be matched with the first file with the appropriate name.</p>
<p>I've been able to reproduce this issue by uploading 2 images with the same name from different directories.</p>

                    </li>
                    
                    <li id="comment-26371">
                        <p class="mb-0"><b>Gregor Moss</b> <i>commented <relative-time datetime="2019-01-29T17:00:54.258-0500">2019-01-29T17:00:54.258-0500</relative-time></i></p>
                        <p>This issue also seems to be happening on the iPad 2 with iOS 9.3.5 with respect to audio and video content that has been captured. This seems to have been solved by iOS 12.1.1, though, as the iPad Mini 2 and iPad Air 2 are able to have multiple captured audio or video blocks.</p>

                    </li>
                    
                    <li id="comment-26372">
                        <p class="mb-0"><b>Gregor Moss</b> <i>commented <relative-time datetime="2020-12-13T21:01:33.248-0500">2020-12-13T21:01:33.248-0500</relative-time></i></p>
                        <p>The switch to a server-side file management setup has solved this issue</p>

                    </li>
                    
                </ul>
            </div>
            
        </div>
    </div>

        </main>
        <footer>
            
<nav aria-labelledby="pagination">
    <h2 class="visually-hidden">pagination</h2>
    <p class="flex">
        
        
        <a class="mx-1" href="/browse/SJRK-183/"><span class="aria-hidden">←</span> Previous: SJRK-183</a>
        <a class="mx-1" href="/browse/SJRK-185/">Next: SJRK-185 <span class="aria-hidden">→</span></a>
    </p>
</nav>

        </footer>
    </body>
</html>