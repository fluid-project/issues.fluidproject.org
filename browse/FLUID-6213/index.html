<!DOCTYPE html>
<html lang="en" dir="ltr" data-color-scheme="light">
    <head>
        <title> FLUID-6213  | Fluid Project Issues Archive</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <meta name="description" content="Archive of Fluid Project issues from the JIRA issue tracker">
        <meta property="og:title" content=" FLUID-6213 |  Fluid Project Issues Archive">
        <meta property="og:description" content="Archive of Fluid Project issues">
        <meta property="og:locale" content="en">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://issues.fluidproject.org/browse/FLUID-6213/">
        <link rel="canonical" href="https://issues.fluidproject.org/browse/FLUID-6213/">


        <link rel="stylesheet" href="/assets/styles/style.css">

        
<script type="module" src="/assets/scripts/relative-time/bundle.js"></script>

    </head>
    <body class="page-issue">
        <header class="mt-3">
            <a class="skip-link" href="#main">Skip to Content</a>
            <nav aria-label="main menu">
                <menu>
                    <li><a rel="home" href="/">Home</a></li>
                    <li><a href="/search/">Search</a></li>
                </menu>
            </nav>
            
        <nav aria-label="breadcrumbs">
            <ol>
                <li><a rel="home" href="/">Home</a></li>
                <li><a href="/projects/FLUID" data-pagefind-filter="project">Fluid Infusion</a></li>
                <li><a href="/browse/FLUID-6213/">FLUID-6213</a></li>
            </ol>
        </nav>
        <h1>FLUID-6213: Subcomponents directly contributed via event arguments to a dynamic component are destroyed if it has a dynamic grade</h1>

        </header>
        <main id="main">
            
    <div id="content" class="content with-sidebar">
        <div class="spacing-y-1 bg-default">
            <h2>Metadata</h2>
            <dl>
                <div>
                    <dt>Source</dt>
                    <dd><a href="https://fluidproject.atlassian.net/browse/FLUID-6213">FLUID-6213</a></dd>
                </div>
                <div>
                    <dt>Type</dt>
                    <dd>
                        <a href="/projects/FLUID/?type=Bug">Bug</a>
                    </dd>
                </div>
                <div>
                    <dt>Priority</dt>
                    <dd>Major</dd>
                </div>
                <div>
                    <dt>Status</dt>
                    <dd>Closed</dd>
                </div>
                <div>
                    <dt>Resolution</dt>
                    <dd>
                            <a href="/projects/FLUID/?resolution=Fixed">Fixed</a>
                        
                    </dd>
                </div>
                <div>
                    <dt>Assignee</dt>
                    <dd>Antranig Basman</dd>
                </div>
                <div>
                    <dt>Reporter</dt>
                    <dd>
                        <a href="/projects/FLUID/?reporter=Antranig%20Basman">Antranig Basman</a>
                    </dd>
                </div>
                <div>
                    <dt>Created</dt>
                    <dd><relative-time datetime="2017-10-17T17:20:15.719-0400" prefix="">2017-10-17T17:20:15.719-0400</relative-time></dd>
                </div>
                <div>
                    <dt>Updated</dt>
                    <dd><relative-time datetime="2024-07-22T09:02:00.305-0400" prefix="">2024-07-22T09:02:00.305-0400</relative-time></dd>
                </div>
                <div>
                    <dt>Versions</dt>
                    <dd>
                        
                        N/A
                        
                    </dd>
                </div>
                <div>
                    <dt>Fixed Versions</dt>
                    <dd>
                        
                        N/A
                        
                    </dd>
                </div>
                <div>
                    <dt>Component</dt>
                    <dd>
                        
                        <ol role="list">
                            
                            <li>Framework</li>
                            
                        </ol>
                        
                    </dd>
                </div>
            </dl>
        </div>

        <div>
            <div class="spacing-y-1">
                <h2>Description</h2>
                <p>An awkward combination of hacks in the pre <a href="/browse/FLUID-6148/">FLUID-6148</a> framework have conspired to produce a dreadful result. If a "totally dynamic component", e.g. with the stereotypical definition</p>
<pre><code class="hljs language-java">dynamicComponents: {
        embranglements: {
            createOnEvent: <span class="hljs-string">"createEmbranglement"</span>,
            type: <span class="hljs-string">"{arguments}.0.type"</span>,
            options: <span class="hljs-string">"{arguments}.0.options"</span>
        }
    },
</code></pre>
<p>has had subcomponent definitions literally contributed within {{ {arguments}.0.options}}, and the resulting component ends up with a dynamic grade, e.g. by being the target of an options distribution, these subcomponent definitions will be completely destroyed. To add insult to injury, the event firer's own argument objects will be corrupted by this process.</p>
<p>The blunder is a combination of our existing crude attempts to deal with <a href="/browse/FLUID-5028/">FLUID-5028</a> by the cursed utility "destroyValue", and our special-casing of "total options arguments" in fluid.makeExpandOptions:</p>
<pre><code class="hljs language-java"><span class="hljs-keyword">else</span> { <span class="hljs-comment">// these init immediately since we must deliver a valid root target</span>
            options.strategy = fluid.concreteTrundler;
            options.initter = fluid.identity;
            <span class="hljs-keyword">if</span> (typeof(source) === <span class="hljs-string">"string"</span>) {
                options.target = options.expandSource(source);
            }
            <span class="hljs-keyword">else</span> {
                options.target = source;
            }
        }
</code></pre>
<p>In this case "expandSource" will create a mergeBlock target which is not only aliased to the object reference of source, but also one which cannot magically regenerate if it is damaged by fluid.destroyValue.</p>
<p>People have been writing these "total options arguments" for a while even though we have hoped that the use cases for them will go away. It seems at least that the target will agree in terms of expansion count with other material which is always a worry.</p>

            </div>
            
            
            
            
            <div class="spacing-y-1">
                <h2>Comments</h2>
                <ul class="spacing-y-2" role="list">
                    
                    <li id="comment-22405">
                        <p class="mb-0"><b>Cindy Li</b> <i>commented <relative-time datetime="2017-10-20T16:35:19.447-0400">2017-10-20T16:35:19.447-0400</relative-time></i></p>
                        <p><a href="https://github.com/fluid-project/infusion/pull/855">The pull request</a> has been merged into the project repo master branch at 17fbd6f293180320c083295a08e9727f4a2c3e3f</p>

                    </li>
                    
                </ul>
            </div>
            
        </div>
    </div>

        </main>
        <footer>
            
<nav aria-labelledby="pagination">
    <h2 class="visually-hidden">pagination</h2>
    <p class="flex">
        
        
        <a class="mx-1" href="/browse/FLUID-6212/"><span class="aria-hidden">←</span> Previous: FLUID-6212</a>
        <a class="mx-1" href="/browse/FLUID-6214/">Next: FLUID-6214 <span class="aria-hidden">→</span></a>
    </p>
</nav>

        </footer>
    </body>
</html>