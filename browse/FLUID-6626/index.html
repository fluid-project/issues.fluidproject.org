<!DOCTYPE html>
<html lang="en" dir="ltr" data-color-scheme="light">
    <head>
        <title> FLUID-6626  | Fluid Project Issues Archive</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <meta name="description" content="Archive of Fluid Project issues from the JIRA issue tracker">
        <meta property="og:title" content=" FLUID-6626 |  Fluid Project Issues Archive">
        <meta property="og:description" content="Archive of Fluid Project issues">
        <meta property="og:locale" content="en">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://issues.fluidproject.org/browse/FLUID-6626/">
        <link rel="canonical" href="https://issues.fluidproject.org/browse/FLUID-6626/">


        <link rel="stylesheet" href="/assets/styles/style.css">

        
<script type="module" src="/assets/scripts/relative-time/bundle.js"></script>

    </head>
    <body class="page-issue">
        <header class="mt-3">
            <a class="skip-link" href="#main">Skip to Content</a>
            <nav aria-label="main menu">
                <menu>
                    <li><a rel="home" href="/">Home</a></li>
                    <li><a href="/search/">Search</a></li>
                </menu>
            </nav>
            
        <nav aria-label="breadcrumbs">
            <ol>
                <li><a rel="home" href="/">Home</a></li>
                <li><a href="/projects/FLUID" data-pagefind-filter="project">Fluid Infusion</a></li>
                <li><a href="/browse/FLUID-6626/">FLUID-6626</a></li>
            </ol>
        </nav>
        <h1>FLUID-6626: Raw github URLs cannot be refreshed more than once every 5 minutes</h1>

        </header>
        <main id="main">
            
    <div id="content" class="content with-sidebar">
        <div class="spacing-y-1 bg-default">
            <h2>Metadata</h2>
            <dl>
                <div>
                    <dt>Source</dt>
                    <dd><a href="https://fluidproject.atlassian.net/browse/FLUID-6626">FLUID-6626</a></dd>
                </div>
                <div>
                    <dt>Type</dt>
                    <dd>
                        <a href="/projects/FLUID/?type=Story">Story</a>
                    </dd>
                </div>
                <div>
                    <dt>Priority</dt>
                    <dd>Major</dd>
                </div>
                <div>
                    <dt>Status</dt>
                    <dd>Closed</dd>
                </div>
                <div>
                    <dt>Resolution</dt>
                    <dd>
                            <a href="/projects/FLUID/?resolution=Migrated">Migrated</a>
                        
                    </dd>
                </div>
                <div>
                    <dt>Assignee</dt>
                    <dd>Antranig Basman</dd>
                </div>
                <div>
                    <dt>Reporter</dt>
                    <dd>
                        <a href="/projects/FLUID/?reporter=Antranig%20Basman">Antranig Basman</a>
                    </dd>
                </div>
                <div>
                    <dt>Created</dt>
                    <dd><relative-time datetime="2021-06-03T08:39:45.299-0400" prefix="">2021-06-03T08:39:45.299-0400</relative-time></dd>
                </div>
                <div>
                    <dt>Updated</dt>
                    <dd><relative-time datetime="2024-07-25T12:49:58.434-0400" prefix="">2024-07-25T12:49:58.434-0400</relative-time></dd>
                </div>
                <div>
                    <dt>Versions</dt>
                    <dd>
                        
                        N/A
                        
                    </dd>
                </div>
                <div>
                    <dt>Fixed Versions</dt>
                    <dd>
                        
                        N/A
                        
                    </dd>
                </div>
                <div>
                    <dt>Component</dt>
                    <dd>
                        
                        <ol role="list">
                            
                            <li>Pluralistic Data Infrastructure</li>
                            
                        </ol>
                        
                    </dd>
                </div>
            </dl>
        </div>

        <div>
            <div class="spacing-y-1">
                <h2>Description</h2>
                <p>As part of the Inverted Wordles project, positioned as an early taster of our pluralistic data infrastructure based on github and other public massive-scale platforms, there was an idea that URLs hosted under raw.githubusercontent.com could be used to circumvent the same origin policy, and be polled regularly in order to update the user visualisation.</p>
<p>There was early resistance to implementing dedicated Netlify proxies for these polls due to the concern that they might eat into our 125,000 per month allowance of requests under their free or OSS tiers. Since the client should realistically poll every 5 to 10 seconds to gives some responsiveness, a number of clients polling these endpoints simultaneously might chew into the request allowance quite fast.</p>
<p>Whilst we found that the CDN hosting raw.githubusercontent.com does indeed set the proper CORS headers, in practice it is incompletely configured in that it does not respond to cache control headers nor preflight CORS requests, and is hardwired behind an HTTP varnish cache that does not allow updates more frequently than every 300 seconds.</p>
<p>Nonetheless, this technique could be useful in other contexts where responsiveness is not so important, so some of the code is reproduced here for reference.</p>
<p>The implementation was contributed in <a href="https://github.com/inclusive-design/inverted-wordles/pull/6">https://github.com/inclusive-design/inverted-wordles/pull/6</a> and had a polling endpoint reading</p>
<pre><code class="hljs language-java"><span class="hljs-comment">// Old implementation, disused since</span>
<span class="hljs-comment">// i) raw.githubusercontent does not permit CORS preflight requests configuring cache control</span>
<span class="hljs-comment">// ii) its cache is hardwired to only update every 300 seconds</span>
<span class="hljs-comment">/*
inverted_wordles.fetchAnswers = function (instance) {
    var url = inverted_wordles.stringTemplate(
        "https://raw.githubusercontent.com/${repo_owner}/${repo_name}/${branch}/src/_data/answers.json", wordle_globals);
    fetch(url, {
        cache: "no-store"
    }
    //, {
    //    headers: {
    //        "Cache-Control": "no-store, max-age=0"
    //    }
    //}).then(function (response) {
        inverted_wordles.handleResponse(instance, response);
    }, function (error) {
        console.log("Error fetching url " + url + ": ", error);
    });
};
*/</span>
</code></pre>
<p>as well as an attempt to set headers as so</p>
<pre><code class="hljs language-java"><span class="hljs-comment">// Unfortunately "Etag" is a censored CORS header so we will have to do change detection by brute force</span>
    <span class="hljs-comment">// https://stackoverflow.com/questions/21345814/etag-header-not-returned-from-jquery-ajax-cross-origin-xhr/21346319</span>
    <span class="hljs-comment">/* for (var pair of response.headers.entries()) {
        console.log(pair[0]+ ": " + pair[1]);
    }*/</span>
</code></pre>

            </div>
            
            
            
            
            <div class="spacing-y-1">
                <h2>Comments</h2>
                <ul class="spacing-y-2" role="list">
                    
                    <li id="comment-27897">
                        <p class="mb-0"><b>Justin Obara</b> <i>commented <relative-time datetime="2024-07-25T12:49:58.246-0400">2024-07-25T12:49:58.246-0400</relative-time></i></p>
                        <p>Migrated to <a href="https://github.com/inclusive-design/covid-data-monitor/issues/39">https://github.com/inclusive-design/covid-data-monitor/issues/39</a> </p>

                    </li>
                    
                </ul>
            </div>
            
        </div>
    </div>

        </main>
        <footer>
            
<nav aria-labelledby="pagination">
    <h2 class="visually-hidden">pagination</h2>
    <p class="flex">
        
        
        <a class="mx-1" href="/browse/FLUID-6625/"><span class="aria-hidden">←</span> Previous: FLUID-6625</a>
        <a class="mx-1" href="/browse/FLUID-6627/">Next: FLUID-6627 <span class="aria-hidden">→</span></a>
    </p>
</nav>

        </footer>
    </body>
</html>