<!DOCTYPE html>
<html lang="en" dir="ltr" data-color-scheme="light">
    <head>
        <title> FLUID-6738  | Fluid Project Issues Archive</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <meta name="description" content="Archive of Fluid Project issues from the JIRA issue tracker">
        <meta property="og:title" content=" FLUID-6738 |  Fluid Project Issues Archive">
        <meta property="og:description" content="Archive of Fluid Project issues">
        <meta property="og:locale" content="en">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://issues.fluidproject.org/browse/FLUID-6738/">
        <link rel="canonical" href="https://issues.fluidproject.org/browse/FLUID-6738/">


        <link rel="stylesheet" href="/assets/styles/style.css">

        
<script type="module" src="/assets/scripts/relative-time/bundle.js"></script>

    </head>
    <body class="page-issue">
        <header class="mt-3">
            <a class="skip-link" href="#main">Skip to Content</a>
            <nav aria-label="main menu">
                <menu>
                    <li><a rel="home" href="/">Home</a></li>
                    <li><a href="/search/">Search</a></li>
                </menu>
            </nav>
            
        <nav aria-label="breadcrumbs">
            <ol>
                <li><a rel="home" href="/">Home</a></li>
                <li><a href="/projects/FLUID" data-pagefind-filter="project">Fluid Infusion</a></li>
                <li><a href="/browse/FLUID-6738/">FLUID-6738</a></li>
            </ol>
        </nav>
        <h1>FLUID-6738: Create facility using workflow functions to allow dependent singletons to be created in a timely way</h1>

        </header>
        <main id="main">
            
    <div id="content" class="content with-sidebar">
        <div class="spacing-y-1 bg-default">
            <h2>Metadata</h2>
            <dl>
                <div>
                    <dt>Source</dt>
                    <dd><a href="https://fluidproject.atlassian.net/browse/FLUID-6738">FLUID-6738</a></dd>
                </div>
                <div>
                    <dt>Type</dt>
                    <dd>
                        <a href="/projects/FLUID/?type=New%20Feature">New Feature</a>
                    </dd>
                </div>
                <div>
                    <dt>Priority</dt>
                    <dd>Major</dd>
                </div>
                <div>
                    <dt>Status</dt>
                    <dd>Pull Request</dd>
                </div>
                <div>
                    <dt>Resolution</dt>
                    <dd>
                            N/A
                        
                    </dd>
                </div>
                <div>
                    <dt>Assignee</dt>
                    <dd>Antranig Basman</dd>
                </div>
                <div>
                    <dt>Reporter</dt>
                    <dd>
                        <a href="/projects/FLUID/?reporter=Antranig%20Basman">Antranig Basman</a>
                    </dd>
                </div>
                <div>
                    <dt>Created</dt>
                    <dd><relative-time datetime="2022-05-27T06:56:57.411-0400" prefix="">2022-05-27T06:56:57.411-0400</relative-time></dd>
                </div>
                <div>
                    <dt>Updated</dt>
                    <dd><relative-time datetime="2022-05-27T11:01:40.504-0400" prefix="">2022-05-27T11:01:40.504-0400</relative-time></dd>
                </div>
                <div>
                    <dt>Versions</dt>
                    <dd>
                        
                        <ol role="list">
                            
                            <li>4.0</li>
                            
                        </ol>
                        
                    </dd>
                </div>
                <div>
                    <dt>Fixed Versions</dt>
                    <dd>
                        
                        N/A
                        
                    </dd>
                </div>
                <div>
                    <dt>Component</dt>
                    <dd>
                        
                        <ol role="list">
                            
                            <li>Framework</li>
                            
                        </ol>
                        
                    </dd>
                </div>
            </dl>
        </div>

        <div>
            <div class="spacing-y-1">
                <h2>Description</h2>
                <p>The code exhibiting <a href="/browse/FLUID-6737/">FLUID-6737</a> was created as a result of what seems to be a recurrent requirement - that multiple "instances" of something be resolvable against a common singleton (conventionally at the root of the tree), where the construction of the singleton should be timed to be "immediately before" the first of the dependent instances.</p>
<p>FLUID-6737 makes use of the "fluid.resolveRootSingle" directive to mount the singleton, expressed as a subcomponent of the client, at the root, but runs into difficulties because each successive instance reconstructs the singleton as its subcomponent.</p>
<p>The Infusion 4.0 "workflow functions", invented to support the "new renderer", should be able to allow this constructional pattern to be expressed in a declarative way.</p>

            </div>
            
            
            
            
            <div class="spacing-y-1">
                <h2>Comments</h2>
                <ul class="spacing-y-2" role="list">
                    
                    <li id="comment-25676">
                        <p class="mb-0"><b>Antranig Basman</b> <i>commented <relative-time datetime="2022-05-27T11:01:40.504-0400">2022-05-27T11:01:40.504-0400</relative-time></i></p>
                        <p>A "test balloon" implementation is available in <a href="https://github.com/fluid-project/infusion/pull/1082/files#">https://github.com/fluid-project/infusion/pull/1082/files#</a> as the grade <code>fluid.rootMaker</code> and its accompanying workflow function. Since this is a global workflow function with priority "first", this acts early enough to resolve references from any options material or model relays etc., although there is one usage which is not possible, which is referencing the created singleton from a directly injected subcomponent reference - e.g.</p>
<pre><code class="hljs language-java">fluid.defaults(<span class="hljs-string">"fluid.tests.fluid6738test"</span>, {
....
    components: {
        webMidi: <span class="hljs-string">"{fluid.tests.fluid6738webMidi}"</span>
    }
});
</code></pre>
<p>would not be possible, since the gap between initComponentShell and processComponentShell in FluidIoC.js is not covered by the workflow system. If this implementation ended up being useful, we could consider hoisting processComponentShell into a new initial workflow phase so that we could place the rootMaker before it - although this would end up not discovering any literal subcomponents that wanted to create roots. Possibly we could just hoist the resolution of injected component references into a workflow phase.</p>

                    </li>
                    
                </ul>
            </div>
            
        </div>
    </div>

        </main>
        <footer>
            
<nav aria-labelledby="pagination">
    <h2 class="visually-hidden">pagination</h2>
    <p class="flex">
        
        
        <a class="mx-1" href="/browse/FLUID-6737/"><span class="aria-hidden">←</span> Previous: FLUID-6737</a>
        <a class="mx-1" href="/browse/FLUID-6739/">Next: FLUID-6739 <span class="aria-hidden">→</span></a>
    </p>
</nav>

        </footer>
    </body>
</html>